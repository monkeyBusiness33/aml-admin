{% extends "layouts/base-fullscreen.html" %}
{% load i18n static %}

{% block title %} 2FA Setup {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

    <section class="vh-100 bg-soft d-flex align-items-center bg-primary">
        <div class="container">
            <div class="row justify-content-center form-bg-image">
                <div class="col-12 d-flex align-items-center justify-content-center">
                    <div class="bg-white shadow border-0 rounded border-light py-4 px-5 w-100 fmxw-500">
                        <div class="text-center text-md-center mb-4 mt-md-0">
                        <img class="mb-3 mt-3" src="{% static 'assets/img/aml_logo_v3_cut.png' %}" alt="Logo" width="250px">
                            <h1 class="mt-3 mb-0 h3">Two-Factor Authentication Setup</h1>
                            <br />
                            <span class="mb-0 text-muted">
                                    {% if wizard.steps.current == 'welcome' %}
                                        <p>{% blocktrans trimmed %}
                                            Follow the steps in this wizard to enable two-factor
                                            authentication.
                                            You need to download and install TOTP application to you'r phone or PC.</p>
                                            <div>
                                            Google Authenticator: <a href="https://apps.apple.com/app/google-authenticator/id388497605">IOS</a>, <a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2">Android</a><br />
                                            Authy: <a href="https://apps.apple.com/app/twilio-authy/id494168017">IOS</a>, <a href="https://play.google.com/store/apps/details?id=com.authy.authy">Android</a>, <a href="https://authy.com/download/">PC (MacOS/Windows)</a>
                                            </div>
                                            {% endblocktrans %}
                                    {% elif wizard.steps.current == 'method' %}
                                        <p>{% blocktrans trimmed %}Please select which authentication method you would
                                            like to use.{% endblocktrans %}</p>
                                    {% elif wizard.steps.current == 'generator' %}
                                        <p>{% blocktrans trimmed %}To start using a token generator, please use your
                                            smartphone to scan the QR code below. For example, use Google
                                            Authenticator. Then, enter the token generated by the app.
                                            {% endblocktrans %}</p>
                                        <p><img src="{{ QR_URL }}" alt="QR Code" /></p>
                                    {% elif wizard.steps.current == 'sms' %}
                                        <p>{% blocktrans trimmed %}Please enter the phone number you wish to receive the
                                        text messages on. This number will be validated in the next step.
                                        {% endblocktrans %}</p>
                                    {% elif wizard.steps.current == 'call' %}
                                        <p>{% blocktrans trimmed %}Please enter the phone number you wish to be called on.
                                        This number will be validated in the next step. {% endblocktrans %}</p>
                                    {% elif wizard.steps.current == 'validation' %}
                                        {% if challenge_succeeded %}
                                        {% if device.method == 'call' %}
                                            <p>{% blocktrans trimmed %}We are calling your phone right now, please enter the
                                            digits you hear.{% endblocktrans %}</p>
                                        {% elif device.method == 'sms' %}
                                            <p>{% blocktrans trimmed %}We sent you a text message, please enter the tokens we
                                            sent.{% endblocktrans %}</p>
                                        {% endif %}
                                        {% else %}
                                        <p class="alert alert-warning" role="alert">{% blocktrans trimmed %}We've
                                            encountered an issue with the selected authentication method. Please
                                            go back and verify that you entered your information correctly, try
                                            again, or use a different authentication method instead. If the issue
                                            persists, contact the site administrator.{% endblocktrans %}</p>
                                        {% endif %}
                                    {% elif wizard.steps.current == 'yubikey' %}
                                        <p>{% blocktrans trimmed %}To identify and verify your YubiKey, please insert a
                                        token in the field below. Your YubiKey will be linked to your
                                        account.{% endblocktrans %}</p>
                                    {% endif %}
                            </span>
                        </div>
                        <form action="" method="post">{% csrf_token %}
                            {% comment %} {% include "two_factor/_wizard_forms.html" %} {% endcomment %}
                            {{ wizard.management_form }}
                            {% comment %} {{ wizard.form }} {% endcomment %}
                            {% for field in wizard.form %}
                            <div class="form-group mb-4">
                            {% include 'includes/_form_field.html' with field=field field_icon_class='fa-key' %}
                            </div>
                            {% endfor %}

                            {# hidden submit button to enable [enter] key #}
                            <input type="submit" value="" class="d-none" />

                            {% if backup_tokens %}
                            <p>{% trans "As a last resort, you can use a backup token:" %}</p>
                            <p>
                                <button name="wizard_goto_step" type="submit" value="backup"
                                        class="btn btn-secondary btn-block">{% trans "Use Backup Token" %}</button>
                            </p>
                            {% endif %}

                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary">{% trans "Next" %}</button>
                            </div>
                        </form>
                        <br />
                        <div class="d-flex justify-content-center align-items-center mt-4">
                            <span class="fw-normal">
                                <a href="https://www.amlglobal.net/" target="_blank">AML Global Limited</a>
                            </span>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </section>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}{% endblock javascripts %}
